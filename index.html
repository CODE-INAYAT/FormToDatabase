<!DOCTYPE html>
<html lang="en">

<head>
    <script src="https://unpkg.com/@dotlottie/player-component@latest/dist/dotlottie-player.mjs" type="module"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registration</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/flowbite/1.6.5/flowbite.min.css" rel="stylesheet" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:ital,wght@0,200..800;1,200..800&display=swap"
        rel="stylesheet">
    <link href='https://fonts.googleapis.com/css?family=JetBrains Mono' rel='stylesheet'>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
</head>

<body>
    <!-- Access Form Overlay -->
    <div id="details-form"
        style="font-family: 'Plus Jakarta Sans', sans-serif; background-color: #e9eef5; display: flex;"
        class="overflow-y-auto form-overlay fixed inset-0 bg-opacity-100 overflow-y-auto h-full w-full flex items-center justify-center z-10 p-3">
        <div style="border-radius: 25px;"
            class="bg-white p-8 rounded-lg shadow-xl w-full max-w-md sm:max-w-md mx-2 sm:mx-0 overflow-y-auto"
            id="formContent">
            <h2 id="register-title" class="text-xl mb-4 text-center text-blue-900" style="font-weight: 460;">
                Registration</h2>
            <form name="google-sheet" method="post" id="accessForm" class="space-y-4">
                <div class="relative z-0">
                    <input type="text" id="name" maxlength="30" name="Name" required oninput=" 
                        convertToUpperCaseAndRemoveNumbers(this);"
                        class="block py-2.5 px-0 w-full text-base text-gray-900 bg-transparent border-0 border-b-2 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 focus:border-blue-600 peer"
                        placeholder=" " />
                    <label for="name"
                        class="absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-6 scale-75 top-3 -z-10 origin-[0] peer-focus:start-0 peer-focus:text-blue-600 peer-focus:dark:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-6 flex items-center">
                        <svg class="w-5 h-5 mr-2 absolute left-0 top-1/2 transform -translate-y-1/2" fill="currentColor"
                            viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z"
                                clip-rule="evenodd"></path>
                        </svg>
                        <span class="ml-7">Name</span>
                    </label>
                    <span id="nameError" class="hidden text-red-600 text-sm">Name should not exceed 45
                        characters.</span>
                </div>

                <div class="relative z-0">
                    <input type="email" id="email" maxlength="50" name="Email" required onclick="showInfoModal()"
                        oninput="convertToLowerCaseAndRemoveSpaces(this)"
                        class="block py-2.5 px-0 w-full text-base text-gray-900 bg-transparent border-0 border-b-2 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 focus:border-blue-600 peer"
                        placeholder=" " autocomplete="off" />
                    <label for="email"
                        class="absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-6 scale-75 top-3 -z-10 origin-[0] peer-focus:start-0 peer-focus:text-blue-600 peer-focus:dark:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-6 flex items-center">
                        <svg class="w-5 h-5 mr-2 absolute left-0 top-1/2 transform -translate-y-1/2" fill="currentColor"
                            viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                            <path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"></path>
                            <path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"></path>
                        </svg>
                        <span class="ml-7">Email</span>
                    </label>
                </div>

                <div class="relative z-0">
                    <label for="Branch" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Select
                        Your
                        Branch</label>
                    <select id="branch" name="Branch"
                        class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500">
                        <option disabled selected>Your Branch</option>
                        <option value="COMPS">COMPS</option>
                        <option value="AI&DS">AI&DS</option>
                        <option value="E&TC">E&TC</option>
                        <option value="IT">IT</option>
                        <option value="MECH">MECH</option>
                        <option value="CIVIL">CIVIL</option>
                        <option value="E&CS">E&CS</option>
                        <option value="MME">MME</option>
                        <option value="CSE">CSE</option>
                        <option value="AI&ML">AI&ML</option>
                        <option value="IoT">IoT</option>
                    </select>
                </div>
                <div class="relative z-0">
                    <label for="Branch" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Select
                        Your
                        Year</label>
                    <select id="year" name="Year" style="font-family: 'JetBrains Mono';"
                        class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500">
                        <option disabled selected>Your Year</option>
                        <option value="I">I</option>
                        <option value="II">II</option>
                        <option value="III">III</option>
                        <option value="IV">IV</option>
                    </select>
                </div>
                <div class="flex justify-center">
                    <button type="submit" id="submit" name="submit"
                        style="box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);"
                        class="text-white bg-blue-700 hover:bg-blue-800 focus:outline-none focus:ring-4 focus:ring-blue-300 font-medium rounded-full text-sm px-5 py-2.5 text-center me-2 mb-2 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800 flex items-center justify-center w-full sm:w-auto">
                        <span id="buttonText">Submit</span>
                        <svg id="buttonArrow" class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                            xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M14 5l7 7m0 0l-7 7m7-7H3">
                            </path>
                        </svg>
                </div>
                </button>
            </form>
        </div>
        <footer class="shadow m-4 bg-gray-800 fixed bottom-0 left-0 right-0"
            style="margin-bottom: 0px; margin-right: 0px; margin-left: 0px; margin-top: 0px; border-top-left-radius:20px; border-top-right-radius:20px;">
            <div class="w-full mx-auto max-w-screen-xl p-1 md:flex md:items-center md:justify-center">
                <span class="footer-text text-xs text-gray-200 sm:text-center"
                    style="font-family: 'JetBrains Mono'; font-size: 13.50px; padding-top: 4px;">Roll No: 24,27 & 23<br>
                    <span class="footer-text text-md text-gray-400 md:text-center" style="padding-top: 6px;">
                        Registration Page
                    </span>
                </span>
            </div>
        </footer>
    </div>
    <!------------------------ Loading overlay(AccessKey Generation) ------------------------------>
    <div id="loading" class="overlay" style="display: none">
        <div class="overlay-content">
            <div class="relative">
                <div class="p-4 md:p-5 text-center">
                    <div class="loading-center">
                        <div role="status">
                            <dotlottie-player
                                src="https://lottie.host/52aa4f06-d4ba-4020-9629-6155177d6138/V5DYX83dKL.json"
                                background="transparent" speed="1" style="width: 250px; height: 250px;" loop
                                autoplay></dotlottie-player>
                            <h4 class="text-gray-700" style="margin-top: 15px; margin-left: -28px;">Please
                                wait!<br>Your Data Is Getting Saved...</h4>
                            <span class="sr-only">Loading...</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-------------------- Success overlay ---------------------->
    <div id="success" style="font-family: 'Plus Jakarta Sans', sans-serif;"
        class="fixed z-10 inset-0 overflow-y-auto hidden flex items-center justify-center p-4"
        aria-labelledby="modal-title" role="dialog" aria-modal="true">
        <div class="w-full max-w-sm sm:max-w-md mx-2 sm:mx-0">
            <div style="background: rgba(0, 0, 0, 0.441); backdrop-filter: blur(5px);
-webkit-backdrop-filter: blur(5px);" class="fixed inset-0 transition-opacity" aria-hidden="true"></div>
            <div style="border-radius: 35px;"
                class="bg-white rounded-lg overflow-hidden shadow-xl transform transition-all w-full">
                <!-- Modal header -->
                <div class="flex items-center justify-between p-1 md:p-5 border-b rounded-t">
                    <h3 class="text-xl font-semibold text-gray-900 w-full text-center">
                        <div class="dotlottie-container">
                            <dotlottie-player
                                src="https://lottie.host/b262bbf7-05a6-4a30-b6e3-648b52389ffe/o5joDCtkZz.json"
                                background="transparent" speed="1" style="width: 80px; height: 80px;" loop
                                autoplay></dotlottie-player>
                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M10 11V6m0 8h.01M19 10a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                        </div>Registration successfull!
                    </h3>
                </div>
                <!-- Modal body -->
                <div class="p-3 md:p-5 space-y-4 text-center">
                    <p class="text-base leading-relaxed ">
                        You Have <span
                            class="bg-blue-100 text-blue-800 font-medium me-2 px-1.5 py-0.5 rounded">Successfully
                            Registered</span> And Your Data Has Been Saved In Database...
                    </p>
                    <div
                        class="flex flex-col sm:flex-row justify-center items-center space-y-2 sm:space-y-0 sm:space-x-4">
                        <a href=""
                            class="text-white bg-green-700 hover:bg-green-800 focus:outline-none focus:ring-4 focus:ring-green-300 font-medium rounded-full text-sm px-5 py-2.5 text-center mb-2 dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800 inline-flex items-center">
                            <svg class="w-6 h-6 mr-2" viewBox="0 0 24 24" fill="currentColor"
                                xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M7.5 7.375C7.5 6.33947 8.33947 5.5 9.375 5.5C10.4105 5.5 11.25 6.33947 11.25 7.375V16.625C11.25 18.489 12.761 20 14.625 20C16.489 20 18 18.489 18 16.625V11.8107L19.2197 13.0303L20.2803 11.9697L17.25 8.93934L14.2197 11.9697L15.2803 13.0303L16.5 11.8107V16.625C16.5 17.6605 15.6605 18.5 14.625 18.5C13.5895 18.5 12.75 17.6605 12.75 16.625V7.375C12.75 5.51104 11.239 4 9.375 4C7.51104 4 6 5.51104 6 7.375V9.5H4V15H9.5V9.5H7.5V7.375ZM5.5 11V13.5H8V11H5.5Z">
                                </path>
                            </svg>
                            <span class="plus-jakarta-sans">OK</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.3.0/flowbite.min.js"></script>
    <script src="https://unpkg.com/@dotlottie/player-component@latest/dist/dotlottie-player.mjs" type="module"></script>
    <script src="script.js"></script>
    <script type="module">

        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js";
        import { getDatabase, ref, set, get, child } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-database.js";

        // API
        const firebaseConfig = {
            apiKey: "AIzaSyBQsKFqSksq-mJHWiXZJBq7uQXI1VscfNI",
            authDomain: "formdatabase-9286d.firebaseapp.com",
            projectId: "formdatabase-9286d",
            storageBucket: "formdatabase-9286d.appspot.com",
            messagingSenderId: "79926329148",
            appId: "1:79926329148:web:33bb11f4d0f3f353ac6839"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        document.getElementById("submit").addEventListener('click', function (e) {
            e.preventDefault();
            document.getElementById("loading").style.display = 'flex';
            document.getElementById("details-form").style.display = 'none';

            // Get user details
            const userName = document.getElementById("name").value;
            const userEmail = document.getElementById("email").value;
            const userBranch = document.getElementById("branch").value;
            const userYear = document.getElementById("year").value;

            set(ref(db, 'user/' + userName), {
                username: userName,
                email: userEmail,
                branch: userBranch,
                year: userYear
            });

            setTimeout(function () {
                document.getElementById("loading").style.display = 'none';
                document.getElementById("success").style.display = 'flex';
                document.getElementById("name").textContent = userName;
            }, 5000);
        });

        document.querySelector('#success a').addEventListener('click', function (e) {
            e.preventDefault();
            document.getElementById("success").style.display = 'none';
            document.getElementById("details-form").style.display = 'flex';
            document.getElementById("accessForm").reset();
        });
    </script>
</body>

</html>